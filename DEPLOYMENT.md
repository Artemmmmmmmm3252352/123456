# Инструкция по развертыванию

## Требования

- Node.js 18+ и npm
- Neon PostgreSQL база данных (или другая PostgreSQL)
- Groq API ключ
- Веб-сервер (nginx, Apache) или хостинг (Vercel, Netlify, etc.)

## Шаги развертывания

### 1. Подготовка переменных окружения

Создайте файл `.env` в корне проекта на основе `.env.example`:

```bash
cp .env.example .env
```

Заполните переменные:
- `VITE_GROQ_API_KEY` - ваш Groq API ключ
- `VITE_DATABASE_URL` - строка подключения к Neon PostgreSQL
- `VITE_ADMIN_PASSWORD` - пароль для доступа к админ-панели

### 2. Установка зависимостей

```bash
npm install
```

### 3. Инициализация базы данных

```bash
# Создать таблицы в базе данных
npm run create-tables

# Проверить подключение
npm run check-db
```

### 4. Сборка проекта

```bash
npm run build
```

Собранные файлы будут в папке `dist/`.

### 5. Развертывание

#### Вариант A: Статический хостинг (Vercel, Netlify)

1. Подключите репозиторий к платформе
2. Установите переменные окружения в настройках проекта
3. Укажите команду сборки: `npm run build`
4. Укажите папку вывода: `dist`

#### Вариант B: Собственный сервер с nginx

1. Скопируйте содержимое `dist/` на сервер
2. Настройте nginx для раздачи статических файлов:

```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /path/to/dist;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }
}
```

3. Настройте SSL (Let's Encrypt):

```bash
sudo certbot --nginx -d your-domain.com
```

### 6. Проверка после развертывания

1. Проверьте подключение к базе данных
2. Проверьте работу AI чата
3. Проверьте доступ к админ-панели
4. Проверьте регистрацию и вход пользователей

## Безопасность

⚠️ **ВАЖНО:**

1. **Никогда не коммитьте `.env` файл в Git**
2. **Используйте сильные пароли для админ-панели**
3. **Настройте HTTPS для продакшена**
4. **Регулярно обновляйте зависимости**: `npm audit fix`
5. **Ограничьте доступ к админ-панели по IP** (опционально)

## Переменные окружения

| Переменная | Описание | Обязательная |
|-----------|----------|--------------|
| `VITE_GROQ_API_KEY` | API ключ Groq для AI чата | Да |
| `VITE_DATABASE_URL` | Строка подключения к PostgreSQL | Да |
| `VITE_ADMIN_PASSWORD` | Пароль для админ-панели | Нет (по умолчанию: admin123) |

## Устранение неполадок

### Ошибка подключения к базе данных

- Проверьте правильность `VITE_DATABASE_URL`
- Убедитесь, что база данных доступна из интернета
- Проверьте SSL настройки в строке подключения

### AI чат не работает

- Проверьте `VITE_GROQ_API_KEY`
- Проверьте лимиты API в консоли Groq

### Админ-панель недоступна

- Проверьте `VITE_ADMIN_PASSWORD`
- Убедитесь, что пользователь имеет роль `admin` в базе данных

## Обновление

1. Получите последние изменения: `git pull`
2. Установите зависимости: `npm install`
3. Пересоберите: `npm run build`
4. Перезапустите сервер/хостинг
